"use strict";function t(){}function e(){throw new Error("Buffer constructor is deprecated. Use Buffer.from() instead.")}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,{_buffer:[],length:0},t)}function r(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}function i(){var t=this,e=this.read();e&&e.length&&m.nextTick(function(){t._readableState.defaultEncoding==G.UTF8&&(e=r(e)),t.emit("data",e,t._readableState.defaultEncoding)})}function o(){this._readableState.flowing&&i.call(this)}function a(){this._readableState.flowing=null,this._readableState.ended=!0}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._readableState=new n({flowing:null,ended:!1,defaultEncoding:G.BINARY}),this.pipes=[],this._read=t.read.bind(this),!this._read)throw new TypeError("_read() is not implemented");if(!this._read instanceof Function)throw new TypeError("'options.read' should be a function, passed",W(t.read))}function u(){var t,e=(t=this._writableState).nodes.apply(t,arguments);return this._writableState.needDrain&&this._writableState.length<this.options.highWaterMark&&(this._writableState.needDrain=!1,this.emit("drain")),e}function c(){var t=this,e=this._writableState;if(!e.corked)if(e.length){var n=function(n){n&&t.emit("error",n),e.consumed=!0,m.nextTick(function(){c.call(t)})};if(!e.corked&&e.consumed)if(e.consumed=!1,this._writev){var r=u.call(this);this._writev(r,n)}else{var i=u.call(this,1)[0];this._write(i.chunk,i.encoding,n)}}else e.ended&&this.emit("finish")}function _(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._write=e.write.bind(this),this._writableState=new n({getBuffer:function(){return t._writableState._buffer},corked:0,consumed:!0,needDrain:!1,ended:!1,decodeStrings:!0})}function l(t){}function h(t,e,n){this.push(t,e),n()}function f(){this.pending=Promise.resolve(null)}function p(t,e,n){var r=this._busState,i=r.incoming,o=r.watching,a=r.frame,s=0,u=0,c=!1;if(o.length)for(;s<t.length;s++){if(a.push(t[s]),!i.length)for(var _ in o)try{i.push({patterns:o[_].patterns,callback:o[_].callback,currentPattern:o[_].patterns[0]instanceof Function?o[_].patterns[0]([]):o[_].patterns[0],arrayOffset:0,patternIndex:0,byteIndex:0,length:0})}catch(t){this.emit("error",t)}for(u=0;u<i.length;){var l=i[u],h=l.currentPattern[l.byteIndex];if(void 0===h||h===t[s])c=!0,l.byteIndex++;else if(h instanceof Array){if(c=!0,l.arrayOffset<=0&&h[0]>0&&(l.arrayOffset=h[0]),--l.arrayOffset>0)continue;l.byteIndex++}else if(h instanceof Function)try{c=!!h.call(this,t[s],l.length,a.slice(-l.length-1)),l.byteIndex++}catch(t){this.emit("error",t),c=!1}else c=!1;if(c)if(l.length++,l.byteIndex>=l.currentPattern.length)if(++l.patternIndex>=l.patterns.length){try{l.callback.call(this,a.splice(-l.length),l.pattern)}catch(t){this.emit("error",t)}i.splice(0)}else{var f=l.patterns[l.patternIndex];l.byteIndex=0;try{f instanceof Function?l.currentPattern=f(a.slice(-l.length)):l.currentPattern=f,u++}catch(t){this.emit("error",t),i.splice(u,1)}}else u++;else i.splice(u,1)}!i.length&&a.length&&this.emit("error",{msg:"Unparsed chunk",data:a.splice(0)})}else this.emit("error",new Error({msg:"Unexpected incoming data",data:t}));n()}function E(t,e){var n=0;!function r(i){void 0!==i||n>=t.length?e(i):M(function(){return t[n++](r)})}()}function N(t,e,n){var r=this,i=this.options.highWaterMark;if(t.length>i){for(var o=[],a=t.length,s=0;a>0;a-=i)!function(n,a){var u=t.slice(a,a+=i);o.push(function(t){return p.call(r,u,e,t)}),s=a}(0,s);E(o,n)}else p.apply(this,arguments)}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};H.call(this,Object.assign({},t,{write:N})),this._setup=t.setup.bind(this),this._busState={watching:[],incoming:[],frame:[],configured:!1}}function R(t){return void 0===t&&(t=!q),t?R.start():R.stop(),!!q}function P(t){return t.reduce(function(t,e){for(t+=e;t>255;){var n=255&t;t>>=8,t+=n-1}return t},0)}function T(t,e,n){return 0===P(n.slice(5))}var I=[{queue:[],handle:!0,tick:!1},{queue:[],handle:!0,tick:!1},{queue:[],handle:!1,tick:!1}],A=!1,D={},v=function(){for(var t in I){if(I[t].queue.length)if(1==I[t].handle){for(var e=0;e<I[t].queue.length;e++)I[t].queue[e]();I[t].queue.splice(0)}else for(var n=I[t].queue.splice(0),r=0;r<n.length;r++)n[r]();I[t].tick=A=!1}},S=function(t){return function(e){I[t].queue.push(e),A||I[t].tick||(I[t].tick=A=!0,setTimeout(v))}},g=S(0),M=S(1),y=S(2),F=function(t,e){for(var n=0;D[n];)n++;return D[n]=setTimeout(function(){D[n]&&(delete D[n],y(t))},e),n},m="undefined"!=typeof process?process:{};m.nextTick=void 0!==m.nextTick?m.nextTick:g;var O={};"function"!=typeof console.time&&(console.time=function(t){O[t]=Date.now()},console.timeEnd=function(t){t in O&&(console.log(t+": "+(Date.now()-O[t]).toFixed(3)+"ms"),delete O[t])}),"function"!=typeof console.error&&(console.error=console.log),Object.assign=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=n,o=Array.isArray(i),a=0,i=o?i:i[Symbol.iterator]();;){var s;if(o){if(a>=i.length)break;s=i[a++]}else{if((a=i.next()).done)break;s=a.value}var u=s;if(u instanceof Object)for(var c in u)t[c]=u[c]}return t};var b=function(t,e,n){try{return Object.defineProperty(t,e,n),t}catch(r){return n.get?t.value=n.get():n.value&&(t[e]=n.value),t}},C=function(t,e){return b(e,"name",{value:t}),e},w="_super",U="_apply",x="_isExtended",L=function(t,e,n,r){t.prototype[n]||b(t.prototype,n,{value:[]}),e.forEach(function(e){var i=!!e.prototype[x],o=!!e.prototype[n],a=t.prototype[n].some(function(t){return t===e}),s=!(i&&r||a);i&&o&&e.prototype[n].forEach(function(e){t.prototype[n].some(function(t){return t===e})||t.prototype[n].push(e)}),s&&t.prototype[n].push(e)})},k=function(){function t(){var e=this,n=arguments;t.prototype[U].forEach(function(r){r!==t&&r.apply(e,n)})}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.apply||(e.apply=[]),e.super||(e.super=[]),e.static||(e.static=[]);var n=e.super[0];e.name||(e.name=n.name),C(e.name,t);for(var r in e.static)for(var i in e.static[r])"prototype"!=i&&b(t,i,{value:proto[i],enumerable:!0,writable:!0});b(t,"prototype",{value:{}}),b(t.prototype,"constructor",{value:n}),b(t.prototype,x,{value:!0});for(var o in e.super){var a=function(){};a.prototype=e.super[o].prototype;var s=new a;for(var u in s)["constructor",x,w,U].indexOf(u)<0&&b(t.prototype,u,{value:s[u],enumerable:!0,writable:!0})}return L(t,e.super,w,!1),L(t,e.apply,U,!0),t};Array.prototype.concat=function(){var t=[];for(var e in this)t.push(this[e]);for(var n in arguments)for(var r in arguments[n])t.push(arguments[n][r]);return t},C("EventEmitter",t),t.prototype.on=function(){return Object.prototype.on.apply(this,arguments),this},t.prototype.once=function(t,e){function n(){return this.removeListener(t,n),e.apply(this,arguments)}return this.on(t,n)};var X=k({name:"Stream",super:[t],apply:[t,C("Stream",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={highWaterMark:t.highWaterMark||128}})]});X.prototype.emit=function(e,n){if("error"===e&&!this["#onerror"]&&!this._events.error)throw new Error(n);return t.prototype.emit.apply(this,arguments)},e.from=function(){var t=[];if("string"==typeof arguments[0]){for(var e in arguments[0])t[e]=arguments[0].charCodeAt(e);t=new Uint8Array(t)}else(arguments[0]instanceof Uint8Array||arguments[0]instanceof Array)&&(t=new Uint8Array(arguments[0]));for(var n=void 0!==arguments[1]?arguments[1]:0,r=void 0!==arguments[2]?arguments[2]:t.length,i=[],o=n;o--;)i[o]=0;for(var a=0;a<t.length&&a<r;a++)i[n+a]=t[a];for(var s=i.length;s<r;s++)i[s]=0;return new Uint8Array(i)},e.concat=function(){var t=arguments[0]||[],n=void 0!==arguments[1]?arguments[1]:t.reduce(function(t,e){return t+e.length},0),r=e.from([],0,n),i=0;return t.forEach(function(t){r.set(t,i),i+=t.length}),r},n.prototype={push:function(t){var n={chunk:e.from(t),next:null};return this._buffer.length&&(this._buffer[this._buffer.length-1].next=n),this._buffer.push(n),this.length+=n.chunk.length,this.length},unshift:function(t){var n={chunk:e.from(t),encoding:"binary",next:null};return this._buffer.length&&(n.next=this._buffer[0]),this._buffer.unshift(n),this.length+=n.chunk.length,this.length},nodes:function(t){var e=this,n=this._buffer.splice(0,t);return n.forEach(function(t){return e.length-=t.chunk.length}),n},at:function(t){if(!(t>=this.length||t<0))for(var e=0;e<this._buffer.length;e++){if(t<this._buffer[e].chunk.length)return{index:t,nodeIndex:e};t-=this._buffer[e].chunk.length}},buffer:function(t){if(void 0===t&&(t=this.length),!this.length)return e.from([]);t>this.length&&(t=this.length);var n=void 0;t&&(n=this.at(t)),n||(n={index:this.length-1,nodeIndex:this._buffer.length-1});var r=e.from([],0,t),i=this.nodes(n.nodeIndex).reduce(function(t,e){return r.set(e.chunk,t),t+=e.chunk.length},0);if(i<t){var o=this.nodes(1).shift();r.set(o.chunk.slice(0,t-i),i),o.chunk=o.chunk.slice(t-i),this.unshift(o)}return r}};var W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G={BINARY:"binary",UTF8:"utf8"};s.prototype={pause:function(){return!1!==this._readableState.flowing&&(this._readableState.flowing=!1,this.emit("pause")),this},resume:function(){return this._readableState.flowing||(this._readableState.flowing=!0,this.emit("resume"),o.call(this)),this},read:function(t){if(t<0)throw new Error('"length" must be more than 0');return this._readableState.ended||(void 0===t?this._readableState.length<this.options.highWaterMark&&this._read(this.options.highWaterMark-this._readableState.length):t>this._readableState.length&&this._read(t-this._readableState.length)),this._readableState.ended?this._readableState.length?this._readableState.buffer():null:void 0!==t&&this._readableState.length<t?null:this._readableState.buffer(t)},push:function(t){if(null===t)return a.call(this),!1;var e=this._readableState.push(t)>this.options.highWaterMark;return e||o.call(this),!e},pipe:function(t){var e=this;if(!this.pipes.some(function(t){t.writable})){var n=function(n,r){t.write(n)||(r.stopped=!0,e.pause(),t.once("drain",function(){e.resume()}))},r={writable:t,listener:n,stopped:void 0};this.on("data",function(t){n(t,r)}).pipes.push(r),t instanceof X&&t.emit("pipe")}return t},unpipe:function(t){if(t){var e=this.pipes.find(function(t){t.writable});e&&this.removeListener("data",e.listener)}else{for(var n=this.pipes,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=o.listener;this.removeListener(a)}this.pipes.splice(0)}},on:function(t,e){return"data"==t&&this.resume(),X.prototype.on.apply(this,arguments)},removeListener:function(t,e){return"data"==t&&this.pause(),X.prototype.removeListener.apply(this,arguments)},isPaused:function(){return!this._readableState.flowing}};var B=k({name:"Readable",super:[X,s],apply:[X,C("Readable",s)]});_.prototype={write:function(t){var e=this._writableState;if(e.ended)throw new Error("Write after end");return this._writableState.push(t),c.call(this),e.length<this.options.highWaterMark},end:function(){return this.write.apply(this,arguments),this._writableState.ended=!0,this},cork:function(){this._writableState.corked++},uncork:function(){this._writableState.corked>0&&(this._writableState.corked--,c.call(this))}};var H=k({name:"Writable",super:[X,_],apply:[X,C("Writable",_)]});k({name:"Duplex",super:[B,H],apply:[B,H,C("Duplex",function(){})]}).prototype.on=function(){return B.prototype.on.apply(this,arguments),this};var Y=k({name:"Duplex",super:[B,H],apply:[B,H,C("Duplex",function(){})]});Y.prototype.on=function(){return B.prototype.on.apply(this,arguments),this};var V=k({name:"Transform",super:[Y],apply:[C("Transform",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Y.call(this,Object.assign({},t,{read:l,write:t.transform}))})]});k({name:"PassThrough",super:[V],apply:[function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};V.call(this,Object.assign({},t,{transform:h}))}]});f.prototype={immediate:function(t){var e=this;return this.pending=Promise.all([this.pending,new Promise(function(e,n){t(e,n)}).catch(function(t){return e.emit("error",t)})]),this},deferred:function(t){var e=this;return this.pending=this.pending.then(function(e){return new Promise(function(e,n){t(e,n)})}).catch(function(t){return e.emit("error",t)}),this}};var K=k({name:"Schedule",super:[t,C("Schedule",f)],apply:[t,C("Schedule",f)]});d.prototype={setup:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.deferred(function(e){return t._busState.configured?Promise.reject("already configured"):(t._busState.configured=!0,t._setup.apply(t,[e].concat(n)))})},watch:function(t,e){var n={patterns:t,callback:e};return this._busState.watching.push(n),n},unwatch:function(t){if(t){var e=this._busState.watching.indexOf(t);e>=0&&this._busState.watching.splice(e,1)}else this._busState.watching.splice(0);return this},rx:function(t,e){var n=this,r=this.watch(t,function(t){var i=n._busState.watching.indexOf(r);i>=0&&n._busState.watching.splice(0,i+1),e(t)});return this},tx:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.deferred(function(){return console.log("tx"),"timeout"in n?new Promise(function(r,i){F(function(){e.write(t),r()},n.timeout)}):(e.write(t),Promise.resolve())})},reset:function(){return this._busState.frame.splice(0),this._busState.incoming.splice(0),this}};var j=k({name:"Bus",super:[H,K,d],apply:[d,K]}),q=!1;R.start=function(){q||(q=!0,R.once(LED2,20,function t(){q&&F(function(){return R.once(LED2,20,t)},980)}))},R.stop=function(){q&&(q=!1)},R.once=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments[2];t.write(!0),F(function(){t.write(!1),n&&n()},e)};var J={PN532_PREAMBLE:0,PN532_STARTCODE1:0,PN532_STARTCODE2:255,PN532_POSTAMBLE:0,PN532_HOSTTOPN532:212,PN532_COMMAND_DIAGNOSE:0,PN532_COMMAND_GETFIRMWAREVERSION:2,PN532_COMMAND_GETGENERALSTATUS:4,PN532_COMMAND_READREGISTER:6,PN532_COMMAND_WRITEREGISTER:8,PN532_COMMAND_READGPIO:12,PN532_COMMAND_WRITEGPIO:14,PN532_COMMAND_SETSERIALBAUDRATE:16,PN532_COMMAND_SETPARAMETERS:18,PN532_COMMAND_SAMCONFIGURATION:20,PN532_COMMAND_POWERDOWN:22,PN532_COMMAND_RFCONFIGURATION:50,PN532_COMMAND_RFREGULATIONTEST:88,PN532_COMMAND_INJUMPFORDEP:86,PN532_COMMAND_INJUMPFORPSL:70,PN532_COMMAND_INLISTPASSIVETARGET:74,PN532_COMMAND_INATR:80,PN532_COMMAND_INPSL:78,PN532_COMMAND_INDATAEXCHANGE:64,PN532_COMMAND_INCOMMUNICATETHRU:66,PN532_COMMAND_INDESELECT:68,PN532_COMMAND_INRELEASE:82,PN532_COMMAND_INSELECT:84,PN532_COMMAND_INAUTOPOLL:96,PN532_COMMAND_TGINITASTARGET:140,PN532_COMMAND_TGSETGENERALBYTES:146,PN532_COMMAND_TGGETDATA:134,PN532_COMMAND_TGSETDATA:142,PN532_COMMAND_TGSETMETADATA:148,PN532_COMMAND_TGGETINITIATORCOMMAND:136,PN532_COMMAND_TGRESPONSETOINITIATOR:144,PN532_COMMAND_TGGETTARGETSTATUS:138,PN532_WAKEUP:85,PN532_SPI_STATREAD:2,PN532_SPI_DATAWRITE:1,PN532_SPI_DATAREAD:3,PN532_SPI_READY:1,PN532_I2C_ADDRESS:36,PN532_I2C_READBIT:1,PN532_I2C_BUSY:0,PN532_I2C_READY:1,PN532_I2C_READYTIMEOUT:20,PN532_MIFARE_ISO14443A:0,MIFARE_CMD_AUTH_A:96,MIFARE_CMD_AUTH_B:97,MIFARE_CMD_READ:48,MIFARE_CMD_WRITE_4:162,MIFARE_CMD_WRITE_16:160,MIFARE_CMD_TRANSFER:176,MIFARE_CMD_DECREMENT:192,MIFARE_CMD_INCREMENT:193,MIFARE_CMD_RESTORE:194,NDEF_URIPREFIX_NONE:0,NDEF_URIPREFIX_HTTP_WWWDOT:1,NDEF_URIPREFIX_HTTPS_WWWDOT:2,NDEF_URIPREFIX_HTTP:3,NDEF_URIPREFIX_HTTPS:4,NDEF_URIPREFIX_TEL:5,NDEF_URIPREFIX_MAILTO:6,NDEF_URIPREFIX_FTP_ANONAT:7,NDEF_URIPREFIX_FTP_FTPDOT:8,NDEF_URIPREFIX_FTPS:9,NDEF_URIPREFIX_SFTP:10,NDEF_URIPREFIX_SMB:11,NDEF_URIPREFIX_NFS:12,NDEF_URIPREFIX_FTP:13,NDEF_URIPREFIX_DAV:14,NDEF_URIPREFIX_NEWS:15,NDEF_URIPREFIX_TELNET:16,NDEF_URIPREFIX_IMAP:17,NDEF_URIPREFIX_RTSP:18,NDEF_URIPREFIX_URN:19,NDEF_URIPREFIX_POP:20,NDEF_URIPREFIX_SIP:21,NDEF_URIPREFIX_SIPS:22,NDEF_URIPREFIX_TFTP:23,NDEF_URIPREFIX_BTSPP:24,NDEF_URIPREFIX_BTL2CAP:25,NDEF_URIPREFIX_BTGOEP:26,NDEF_URIPREFIX_TCPOBEX:27,NDEF_URIPREFIX_IRDAOBEX:28,NDEF_URIPREFIX_FILE:29,NDEF_URIPREFIX_URN_EPC_ID:30,NDEF_URIPREFIX_URN_EPC_TAG:31,NDEF_URIPREFIX_URN_EPC_PAT:32,NDEF_URIPREFIX_URN_EPC_RAW:33,NDEF_URIPREFIX_URN_EPC:34,NDEF_URIPREFIX_URN_NFC:35,PN532_GPIO_VALIDATIONBIT:128,PN532_GPIO_P30:0,PN532_GPIO_P31:1,PN532_GPIO_P32:2,PN532_GPIO_P33:3,PN532_GPIO_P34:4,PN532_GPIO_P35:5,PN532_SAM_NORMAL_MODE:1,PN532_SAM_VIRTUAL_CARD:2,PN532_SAM_WIRED_CARD:3,PN532_SAM_DUAL_CARD:4,PN532_BRTY_ISO14443A:0,PN532_BRTY_ISO14443B:3,PN532_BRTY_212KBPS:1,PN532_BRTY_424KBPS:2,PN532_BRTY_JEWEL:4,NFC_WAIT_TIME:30,NFC_CMD_BUF_LEN:64,NFC_FRAME_ID_INDEX:6},Q=J.PN532_PREAMBLE,Z=J.PN532_STARTCODE1,z=J.PN532_STARTCODE2,$=J.PN532_POSTAMBLE,tt=J.PN532_HOSTTOPN532,et=J.PN532_COMMAND_SAMCONFIGURATION,nt=J.PN532_COMMAND_INLISTPASSIVETARGET,rt=J.PN532_COMMAND_INDATAEXCHANGE,it=J.PN532_WAKEUP,ot=J.MIFARE_CMD_AUTH_A,at=J.MIFARE_CMD_READ,st=J.MIFARE_CMD_WRITE_4,ut=J.PN532_SAM_NORMAL_MODE,ct=function(t){var e=void 0,n=[Q,Z,z,t.length+1,255&~t.length,tt].concat(t),r=-n[0];for(e in n)r+=n[e];n.push(255&~r),r=0;for(e in n)r+=n[e];return n.push($),new Uint8ClampedArray(n)},_t={TNF_EMPTY:0,TNF_WELL_KNOWN:1,TNF_MIME_MEDIA:2,TNF_ABSOLUTE_URI:3,TNF_EXTERNAL_TYPE:4,TNF_UNKNOWN:5,TNF_UNCHANGED:6,TNF_RESERVED:7,RTD_TEXT:"T",RTD_URI:"U",RTD_SMART_POSTER:"Sp",RTD_ALTERNATIVE_CARRIER:"ac",RTD_HANDOVER_CARRIER:"Hc",RTD_HANDOVER_REQUEST:"Hr",RTD_HANDOVER_SELECT:"Hs",BLOCK_SIZE:16,TLV_START:64,TL_LENGTH:4},lt=function(t){var n=63&t[0];t.slice(1,1+n);return e.from(t.slice(n+1)).toString()},ht=function(t,n,r){return n||(n="en"),e.from([n.length].concat([].slice.call(e.from(n+t))))},ft=["","http://www.","https://www.","http://","https://","tel:","mailto:","ftp://anonymous:anonymous@","ftp://ftp.","ftps://","sftp://","smb://","nfs://","ftp://","dav://","news:","telnet://","imap:","rtsp://","urn:","pop:","sip:","sips:","tftp:","btspp://","btl2cap://","btgoep://","tcpobex://","irdaobex://","file://","urn:epc:id:","urn:epc:tag:","urn:epc:pat:","urn:epc:raw:","urn:epc:","urn:nfc:"],pt=function(t){var n=ft[t[0]];return n||(n=""),n+e.from(t.slice(1)).toString()},Et=function(t,n,r,i,o){return t||(t=_t.TNF_EMPTY),n||(n=[]),r||(r=[]),i||(i=[]),n instanceof Array&&(n=e.from(n).toString()),r instanceof Array||(r=e.from(r)),i instanceof Array||(i=e.from(i)),t==_t.TNF_WELL_KNOWN&&(n==_t.RTD_TEXT?o=lt(i):n==_t.RTD_URI&&(o=pt(i))),{tnf:t,type:n,id:r,payload:i,value:o}},Nt=function(t,e,n,r,i,o,a){return a||(a=o),t&&(a|=128),e&&(a|=64),n&&(a|=32),r&&(a|=16),i&&(a|=8),a};R();var dt=function(t){var n=[],r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,_=void 0,l=void 0;for(s=0;s<t.length;s++)u=0===s,c=s===t.length-1,_=t[s].payload.length<255,l=t[s].id.length>0,r=Nt(u,c,!1,_,l,t[s].tnf),n.push(r),i=[].slice.call(e.from(t[s].type)),n.push(i.length),_?(o=t[s].payload.length,n.push(o)):(o=t[s].payload.length,n.push(o>>24),n.push(o>>16),n.push(o>>8),n.push(255&o)),l&&(a=t[s].id.length,n.push(a)),n=n.concat(i),l&&(n=n.concat(t[s].id)),n=n.concat([].slice.call(t[s].payload));return n}([function(t,e,n){return Et(_t.TNF_WELL_KNOWN,_t.RTD_TEXT,n||[],ht(t,e))}("2enhello world!")]),Rt=[[0,0,255,void 0,function(t,e,n){return 0===P(n.slice(-2))},213],function(t){for(var e=[],n=0;n<t[3]-1;n++)e.push(void 0);return e},[T,0]],Pt=[[0,0,255,1,255,void 0,T,0]],Tt=[new Uint8ClampedArray([0,0,255,0,255,0])],It=ct([it]),At=ct([et,ut,20,0]),Dt=new j({setup:function(t){var e=this;Serial1.setup(115200,{rx:B7,tx:B6}),Serial1.write(It),Serial1.write(At),F(function(){Serial1.read(),Serial1.pipe(e)},1500),F(function(){R.once(LED1,20,function(){return F(function(){return R.once(LED1,20)},200)}),t()},2e3)},highWaterMark:64});Dt.on("error",console.error),Dt.setup(Serial1);var vt=new Uint8ClampedArray([255,255,255,255,255,255]);!function t(){var e=void 0,n=4;Dt.deferred(function(t){var n=ct([nt,1,0]);Dt.rx(Tt,function(t){console.log("ACK")}),Dt.rx(Rt,function(n){var r=n.slice(7,5+n[3]),i=r[5],o=r.slice(6,6+i);console.log("FOUND",[n[6],r[0],r.slice(2,4),r[4]][2]),e=o,t()}),Serial1.write(n)}),Dt.deferred(function(t,r){var i=ct([rt,1,ot,n].concat(vt).concat(e));Dt.rx(Tt,function(t){}),Dt.rx(Pt,r),Dt.rx(Rt,function(e){console.log("AUTH SUCCEED"),t()}),Serial1.write(i)}),Dt.deferred(function(t,e){var r=ct([rt,1,st,n].concat(dt));Dt.rx(Tt,function(t){}),Dt.rx(Pt,e),Dt.rx(Rt,function(e){console.log("WRITE SUCCEED"),t()}),Serial1.write(r)}),Dt.deferred(function(t,e){console.log("READ");var r=ct([rt,1,at,n]);Dt.rx(Tt,function(t){}),Dt.rx(Rt,function(e){console.log("RED",e),t()}),Serial1.write(r)}),Dt.deferred(function(e){F(function(){console.log(m.memory()),e(),t()},1e3)})}();
//# sourceMappingURL=index.esp.min.js.map
